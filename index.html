<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Happy Birthday Maa..! ‚ù§Ô∏è</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#000;color:#ffd6e8;overflow:hidden;font-family:'Pacifico',cursive}

/* ===== VERIFICATION SCREEN ===== */
#verification{
  position:fixed;inset:0;
  background:linear-gradient(135deg, #0f0c29, #302b63, #24243e);
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  z-index:5000;
  padding:20px;
}

.verification-box{
  background:rgba(255, 182, 193, 0.15);
  backdrop-filter:blur(15px);
  border-radius:30px;
  padding:50px 40px;
  text-align:center;
  max-width:550px;
  width:90%;
  border:4px solid rgba(255, 182, 193, 0.4);
  box-shadow:0 20px 60px rgba(255, 105, 180, 0.6),
             inset 0 0 30px rgba(255, 255, 255, 0.1);
  animation:float 3s ease-in-out infinite;
  position:relative;
  overflow:hidden;
}

.verification-box::before{
  content:'';
  position:absolute;
  top:-50%;
  left:-50%;
  width:200%;
  height:200%;
  background:radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
  background-size:30px 30px;
  animation:twinkle 10s linear infinite;
  z-index:-1;
}

@keyframes float{
  0%,100%{transform:translateY(0) rotate(0.5deg);}
  50%{transform:translateY(-15px) rotate(-0.5deg);}
}

@keyframes twinkle{
  0%{transform:rotate(0deg);}
  100%{transform:rotate(360deg);}
}

.verification-title{
  color:#ffb6c1;
  font-size:3rem;
  margin-bottom:25px;
  text-shadow:0 0 30px #ff69b4,
              0 0 60px #ff1493;
  font-family:'Great Vibes', cursive;
  letter-spacing:2px;
}

.verification-question{
  color:#ffebf3;
  font-size:2.2rem;
  margin-bottom:35px;
  line-height:1.4;
  background:linear-gradient(45deg, #ffb6c1, #ff69b4);
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent;
  font-weight:bold;
}

.input-container{
  position:relative;
  margin-bottom:35px;
}

.input-container::before{
  content:'üîë';
  position:absolute;
  left:20px;
  top:50%;
  transform:translateY(-50%);
  font-size:1.5rem;
  z-index:2;
}

.verification-input{
  width:100%;
  padding:20px 20px 20px 60px;
  font-size:1.8rem;
  background:rgba(255, 255, 255, 0.12);
  border:3px solid #ffb6c1;
  border-radius:20px;
  color:#fff;
  font-family:'Pacifico',cursive;
  outline:none;
  transition:all 0.4s ease;
  box-shadow:0 5px 20px rgba(0,0,0,0.3);
  letter-spacing:1px;
}

.verification-input:focus{
  background:rgba(255, 255, 255, 0.2);
  box-shadow:0 0 40px #ff69b4,
             inset 0 0 20px rgba(255,255,255,0.1);
  border-color:#ff69b4;
  transform:scale(1.02);
}

.verification-button{
  background:linear-gradient(135deg,#ff69b4,#ff1493,#ff6ec7);
  color:white;
  border:none;
  padding:20px 50px;
  font-size:1.8rem;
  border-radius:50px;
  cursor:pointer;
  font-family:'Pacifico',cursive;
  transition:all 0.4s ease;
  margin-top:20px;
  box-shadow:0 10px 30px rgba(255,105,180,0.5);
  position:relative;
  overflow:hidden;
  letter-spacing:1px;
  text-shadow:0 2px 5px rgba(0,0,0,0.3);
}

.verification-button::before{
  content:'';
  position:absolute;
  top:0;left:-100%;
  width:100%;height:100%;
  background:linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  transition:0.5s;
}

.verification-button:hover{
  transform:translateY(-5px) scale(1.05);
  box-shadow:0 15px 40px rgba(255,105,180,0.7);
}

.verification-button:hover::before{
  left:100%;
}

.verification-button:active{
  transform:translateY(2px);
}

.error-message{
  color:#ff6b9d;
  font-size:1.4rem;
  margin-top:20px;
  min-height:30px;
  animation:shake 0.5s ease;
  background:rgba(255,107,157,0.1);
  padding:10px;
  border-radius:10px;
  border:2px solid #ff6b9d;
}

@keyframes shake{
  0%,100%{transform:translateX(0);}
  25%{transform:translateX(-10px);}
  75%{transform:translateX(10px);}
}

.success-message{
  color:#4effe6;
  font-size:1.4rem;
  margin-top:20px;
  background:rgba(78, 255, 230, 0.1);
  padding:10px;
  border-radius:10px;
  border:2px solid #4effe6;
  animation:pulseSuccess 1s infinite;
}

@keyframes pulseSuccess{
  0%,100%{box-shadow:0 0 10px #4effe6;}
  50%{box-shadow:0 0 30px #4effe6;}
}

.verification-emoji{
  font-size:5rem;
  margin-bottom:30px;
  animation:bounce 2s infinite, rotate 10s linear infinite;
  filter:drop-shadow(0 0 20px rgba(255,105,180,0.8));
}

@keyframes bounce{
  0%,100%{transform:translateY(0) scale(1);}
  50%{transform:translateY(-25px) scale(1.1);}
}

@keyframes rotate{
  from{transform:rotate(0deg);}
  to{transform:rotate(360deg);}
}

.hint{
  color:#ffd1dc;
  font-size:1.4rem;
  margin-top:25px;
  opacity:0.9;
  font-style:italic;
  background:rgba(255, 182, 193, 0.2);
  padding:12px;
  border-radius:12px;
  border-left:4px solid #ff69b4;
}

.decorative-hearts{
  position:absolute;
  font-size:2rem;
  animation:floatAround 15s linear infinite;
  opacity:0.7;
}

@keyframes floatAround{
  0%{transform:translate(0,0) rotate(0deg);}
  25%{transform:translate(100px,-50px) rotate(90deg);}
  50%{transform:translate(0,-100px) rotate(180deg);}
  75%{transform:translate(-100px,-50px) rotate(270deg);}
  100%{transform:translate(0,0) rotate(360deg);}
}

/* ===== TERMINAL ===== */
#terminal{
  position:fixed;inset:0;padding:16px;
  font-family:"Courier New",monospace;font-size:15px;
  line-height:1.7;background:#000;color:#ffd6e8;z-index:1000;
  display:none;
}
.cursor{animation:blink 1s infinite}
@keyframes blink{50%{opacity:0}}

/* Audio Instruction */
#audioInstruction{
  display:none;
  position:fixed;
  top:20px;left:50%;
  transform:translateX(-50%);
  color:#ff69b4;
  font-family:'Pacifico',cursive;
  font-size:1.2rem;
  background:rgba(0,0,0,0.8);
  padding:12px 20px;
  border-radius:15px;
  z-index:9999;
  text-align:center;
  border:2px solid #ff69b4;
  animation:pulse 2s infinite;
}
@keyframes pulse{
  0%,100%{box-shadow:0 0 10px #ff69b4}
  50%{box-shadow:0 0 20px #ff69b4}
}

/* ===== SLIDESHOW ===== */
#surprise{display:none;position:fixed;inset:0;background:radial-gradient(circle,#000,#12000a)}
.slide{position:absolute;inset:0;opacity:0;transition:opacity 1s ease;display:flex;align-items:center;justify-content:center}
.slide.active{opacity:1}

/* Cinematic mode for images */
.slide img{
  width:100%;height:100%;
  object-fit:cover;
  animation:cinematicZoom 12s ease-in-out forwards;
  filter:brightness(0.9) contrast(1.1);
}
@keyframes cinematicZoom{
  0%{transform:scale(1.1) translateY(0);}
  50%{transform:scale(1) translateY(-10px);}
  100%{transform:scale(1.08) translateY(0);}
}

.text{
  position:absolute;bottom:15%;width:100%;
  text-align:center;font-family:'Dancing Script', cursive;
  font-size:2.5rem;color:#fff;text-shadow:0 0 20px rgba(255,105,180,0.8);
  opacity:0;animation:textFade 3s ease forwards 1.5s;
  padding:20px;background:rgba(0,0,0,0.7);
  border-radius:15px;margin:0 auto;max-width:90%;
  border:2px solid rgba(255,105,180,0.5);
  backdrop-filter:blur(5px);
}
@keyframes textFade{to{opacity:1}}

.emoji-frame{
  position:absolute;top:10%;width:100%;
  text-align:center;font-size:4rem;
  opacity:0;animation:emojiPop 2s ease forwards;
  text-shadow:0 0 30px rgba(255,105,180,0.8);
}
@keyframes emojiPop{to{opacity:1}}

/* Special design for final slide (7.jpeg) */
.final{
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  background:radial-gradient(circle,#12000a,#000);
}
.final img{
  width:280px;height:280px; /* Made bigger */
  border-radius:50%;
  box-shadow:0 0 80px #ff69b4,
             0 0 120px rgba(255,105,180,0.5),
             inset 0 0 40px rgba(255,255,255,0.2);
  margin-bottom:30px;object-fit:cover;
  border:8px solid rgba(255,105,180,0.3);
  animation:heartbeat 3s ease-in-out infinite,
            rotateGlow 6s linear infinite;
}
@keyframes heartbeat{
  0%,100%{transform:scale(1);}
  50%{transform:scale(1.05);}
}
@keyframes rotateGlow{
  0%{box-shadow:0 0 80px #ff69b4,
               0 0 120px rgba(255,105,180,0.5);}
  50%{box-shadow:0 0 100px #ff69b4,
               0 0 140px rgba(255,105,180,0.7);}
  100%{box-shadow:0 0 80px #ff69b4,
               0 0 120px rgba(255,105,180,0.5);}
}

.final .text{
  background:rgba(0,0,0,0.8);
  border:3px solid #ff69b4;
  padding:25px;
  font-size:3rem;
  animation:finalTextGlow 2s ease-in-out infinite alternate;
}
@keyframes finalTextGlow{
  from{box-shadow:0 0 20px rgba(255,105,180,0.5);}
  to{box-shadow:0 0 40px rgba(255,105,180,0.8);}
}

.final h1{
  font-family:'Pacifico',cursive;
  color:#ff69b4;font-size:4rem;
  text-align:center;
  margin-bottom:20px;
  text-shadow:0 0 30px #ff69b4;
  animation:titlePulse 2s ease-in-out infinite;
}
@keyframes titlePulse{
  0%,100%{transform:scale(1);}
  50%{transform:scale(1.05);}
}

/* Photo Collage Container */
#photoCollage{
  display:none;
  position:fixed;inset:0;
  background:radial-gradient(circle,#12000a,#000);
  z-index:4000;
  padding:20px;
}

/* Collage Grid Layout - Display all 7 photos */
/* Container becomes vertical story feed */
.collage-container{
  display: flex;
  flex-direction: column;
  gap: 18px;
  width: 100%;
  max-width: 420px;   /* story-like narrow width */
  margin: 0 auto;
  padding: 10px;
}

/* Story bubble */
.collage-item{
  width: 70%;
  aspect-ratio: 3 / 4;   /* story photo ratio */
  position: relative;
  border-radius: 18px;
  overflow: hidden;
  box-shadow: 0 8px 25px rgba(255,105,180,0.25);
  border: 2px solid rgba(255,105,180,0.25);
  transition: transform 0.3s ease;
}

/* Zig-zag alignment */
.collage-item:nth-child(odd){
  align-self: flex-start; /* left */
}

.collage-item:nth-child(even){
  align-self: flex-end;   /* right */
}

/* Image styling */
.collage-item img{
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.4s ease;
}

/* Soft zoom on hover */
.collage-item:hover img{
  transform: scale(1.08);
}

/* Highlight middle photo (4th one) */
.collage-item:nth-child(4){
  width: 85%;
  align-self: center;
  border: 3px solid rgba(255,105,180,0.6);
  box-shadow: 0 0 35px rgba(255,105,180,0.6);
}

/* Birthday message over collage */
.collage-message{
  position:absolute;
  bottom:0;left:0;right:0;
  background:linear-gradient(transparent, rgba(0,0,0,0.9));
  color:#fff;
  padding:30px;
  text-align:center;
  font-family:'Pacifico',cursive;
  z-index:2;
  animation:messageFadeIn 2s ease forwards;
}

@keyframes messageFadeIn{
  from{opacity:0; transform:translateY(50px);}
  to{opacity:1; transform:translateY(0);}
}

.collage-message h1{
  font-size:3.5rem;
  color:#ff69b4;
  margin-bottom:15px;
  text-shadow:0 0 20px rgba(255,105,180,0.8);
}

.collage-message p{
  font-size:1.5rem;
  line-height:1.6;
  max-width:800px;
  margin:0 auto;
}

/* Love Emoji Burst */
#loveBurst{
  display:none;
  position:fixed;inset:0;
  background:radial-gradient(circle,#12000a,#000);
  z-index:6000;
  overflow:hidden;
}

.center-burst{
  position:absolute;
  top:50%;left:50%;
  transform:translate(-50%,-50%);
  font-size:8rem;
  animation:pulseHeart 2s infinite;
}

@keyframes pulseHeart{
  0%,100%{transform:translate(-50%,-50%) scale(1);}
  50%{transform:translate(-50%,-50%) scale(1.2);}
}

.love-emoji{
  position:absolute;
  font-size:2.5rem;
  animation:flyOut 3s ease-out forwards;
  opacity:0;
}

@keyframes flyOut{
  0%{
    opacity:1;
    transform:translate(-50%,-50%) scale(0.5) rotate(0deg);
  }
  100%{
    opacity:0;
    transform:translate(var(--tx), var(--ty)) scale(1) rotate(360deg);
  }
}

/* Hearts and Crackers */
.heart, .cracker{position:fixed;bottom:-20px;font-size:24px;animation:floatUp 6s linear;z-index:1}
.heart{color:#ff69b4}
.cracker{color:#FFD700;font-size:28px}
@keyframes floatUp{
  to{
    transform:translateY(-110vh) rotate(360deg);
    opacity:0
  }
}

/* Mobile Responsive */
@media(max-width:768px){
  .verification-box{padding:40px 25px;}
  .verification-title{font-size:2.5rem;}
  .verification-question{font-size:1.8rem;}
  .verification-input{font-size:1.5rem;padding:18px 18px 18px 50px;}
  .verification-button{font-size:1.5rem;padding:18px 40px;}
  .verification-emoji{font-size:4rem;}
  .hint{font-size:1.2rem;}
  
  .text{font-size:1.8rem;padding:15px}
  .emoji-frame{font-size:3rem;top:5%}
  .final img{width:220px;height:220px}
  .final h1{font-size:2.8rem}
  .final .text{font-size:2.2rem;padding:15px}
  .center-burst{font-size:5rem}
  #audioInstruction{font-size:1rem;padding:10px;width:90%}
  .collage-container{
    grid-template-columns:repeat(2, 1fr);
    grid-template-rows:repeat(4, 1fr);
    gap:10px;
  }
  .collage-item:nth-child(1){grid-column:1;grid-row:1;}
  .collage-item:nth-child(2){grid-column:2;grid-row:1;}
  .collage-item:nth-child(3){grid-column:1;grid-row:2;}
  .collage-item:nth-child(4){
    grid-column:2;
    grid-row:2;
    border-width:4px;
  }
  .collage-item:nth-child(5){grid-column:1;grid-row:3;}
  .collage-item:nth-child(6){grid-column:2;grid-row:3;}
  .collage-item:nth-child(7){grid-column:1;grid-row:4;}
  .collage-message h1{font-size:2.5rem}
  .collage-message p{font-size:1.2rem}
}

@media(max-width:480px){
  .verification-title{font-size:2rem;}
  .verification-question{font-size:1.5rem;}
  .verification-input{font-size:1.3rem;padding:15px 15px 15px 45px;}
  .verification-button{font-size:1.3rem;padding:15px 30px;}
  .verification-emoji{font-size:3rem;}
  
  .text{font-size:1.5rem;padding:12px;bottom:10%}
  .emoji-frame{font-size:2.5rem}
  .slide img{object-position:center}
  .final img{width:180px;height:180px;border-width:5px}
  .final h1{font-size:2.2rem}
  .final .text{font-size:1.8rem;padding:10px}
  .center-burst{font-size:3.5rem}
  .love-emoji{font-size:2rem}
  .collage-container{
    grid-template-columns:1fr;
    grid-template-rows:repeat(7, 1fr);
    gap:8px;
  }
  .collage-item:nth-child(1){grid-column:1;grid-row:1;}
  .collage-item:nth-child(2){grid-column:1;grid-row:2;}
  .collage-item:nth-child(3){grid-column:1;grid-row:3;}
  .collage-item:nth-child(4){
    grid-column:1;
    grid-row:4;
    border-width:3px;
  }
  .collage-item:nth-child(5){grid-column:1;grid-row:5;}
  .collage-item:nth-child(6){grid-column:1;grid-row:6;}
  .collage-item:nth-child(7){grid-column:1;grid-row:7;}
  .collage-message{padding:15px;}
  .collage-message h1{font-size:2rem}
  .collage-message p{font-size:1rem}
}
</style>
</head>
<body>

<!-- Verification Screen -->
<div id="verification">
  <div class="verification-emoji">üîêüíñ</div>
  <div class="verification-box">
    <h1 class="verification-title">Secret Access ‚ú®</h1>
    <p class="verification-question">What do I call you most? üí≠</p>
    
    <div class="input-container">
      <input type="text" id="nicknameInput" class="verification-input" 
             placeholder="Type your answer..." autocomplete="off">
    </div>
    
    <button id="verifyButton" class="verification-button">
      Unlock My Heart üîì
    </button>
    
    <div id="errorMessage" class="error-message"></div>
    <div id="successMessage" class="success-message"></div>
    
    <p class="hint">üí° Hint: It's your special nickname! Think sweetly...</p>
  </div>
  
  <!-- Decorative floating hearts -->
  <div class="decorative-hearts" style="top:10%;left:10%;animation-delay:0s;">‚ù§Ô∏è</div>
  <div class="decorative-hearts" style="top:20%;right:15%;animation-delay:2s;">üíï</div>
  <div class="decorative-hearts" style="bottom:30%;left:15%;animation-delay:4s;">üíñ</div>
  <div class="decorative-hearts" style="bottom:20%;right:10%;animation-delay:6s;">üíó</div>
</div>

<!-- Terminal (hidden initially) -->
<div id="terminal"></div>
<div id="audioInstruction">üéµ Click anywhere to start the music! üéµ</div>

<!-- Slideshow -->
<div id="surprise">
  <!-- Romantic and sweet texts -->
  <div class="slide active">
    <img src="./1.jpeg" alt="1">
    <div class="emoji-frame">üíñüå∏üíñ</div>
    <div class="text">Your smile lights up my world brighter than any star ‚ú®</div>
  </div>
  <div class="slide">
    <img src="./2.jpeg" alt="2">
    <div class="emoji-frame">ü•∞üíïü•∞</div>
    <div class="text">In your eyes, I found my home and my peace üè°üíó</div>
  </div>
  <div class="slide">
    <img src="./3.jpeg" alt="3">
    <div class="emoji-frame">‚ú®üòä‚ú®</div>
    <div class="text">Every moment with you feels like a beautiful dream üí≠üíñ</div>
  </div>
  <div class="slide">
    <img src="./4.jpeg" alt="4">
    <div class="emoji-frame">üåπüíòüåπ</div>
    <div class="text">Your laughter is my favorite melody üé∂üíï</div>
  </div>
  <div class="slide">
    <img src="./5.jpeg" alt="5">
    <div class="emoji-frame">üéÇüíùüéÇ</div>
    <div class="text">Wishing you the happiest birthday, Bannu‚ú®</div>
  </div>
  <div class="slide">
    <img src="./6.jpeg" alt="6">
    <div class="emoji-frame">üíçüíñüíç</div>
    <div class="text">My heart has found its forever in you üíû</div>
  </div>
  <div class="slide final">
    <img src="./7.jpeg" alt="7">
    <h1>Happy Birthday Ammu üéÇ</h1>
    <div class="text">You are the best thing that ever happened to me üí´üíñ</div>
  </div>
  <audio id="bgm" src="./song.mp3" preload="auto" loop></audio>
</div>

<!-- Photo Collage - Showing all 7 photos in 3x3 grid -->
<div id="photoCollage">
  <div class="collage-container">
    <div class="collage-item"><img src="./1.jpeg" alt="Memory 1"></div>
    <!-- <div class="collage-item"><img src="./2.jpeg" alt="Memory 2"></div> -->
    <div class="collage-item"><img src="./3.jpeg" alt="Memory 3"></div>
    <!-- <div class="collage-item"><img src="./4.jpeg" alt="Memory 4"></div> -->
    <div class="collage-item"><img src="./5.jpeg" alt="Memory 5"></div>
    <div class="collage-item"><img src="./6.jpeg" alt="Memory 6"></div>
    <!-- <div class="collage-item"><img src="./7.jpeg" alt="Memory 7"></div> -->
  </div>
  <div class="collage-message">
    <h1>Happy Birthday Ammu üíñ</h1>
    <p>
      You are my soft place, my loud laugh, and my forever smile üòä<br>
      Thank you for being you ‚Äî today and always.
    </p>
  </div>
</div>

<!-- Love Emoji Burst -->
<div id="loveBurst">
  <div class="center-burst">üíñ</div>
</div>

<!-- Hidden audio for typing sounds -->
<audio id="typeSound" preload="auto"></audio>

<script>
// ===== VERIFICATION SYSTEM =====
const verification = document.getElementById('verification');
const nicknameInput = document.getElementById('nicknameInput');
const verifyButton = document.getElementById('verifyButton');
const errorMessage = document.getElementById('errorMessage');
const successMessage = document.getElementById('successMessage');

const correctAnswers = ['ammu', 'bannu', 'Ammu', 'Bannu', 'AMMU', 'BANNU'];

// Check if already verified (using localStorage)
function checkIfAlreadyVerified() {
  const isVerified = localStorage.getItem('birthdayVerified');
  if (isVerified === 'true') {
    // Skip verification and start directly
    startMainExperience();
  }
}

// Check on page load
window.addEventListener('load', () => {
  checkIfAlreadyVerified();
  nicknameInput.focus();
});

// Love emojis for burst effect
const loveEmojis = ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíì', 'üíû', 'üíò', 'ü•∞', 'üòç', 'ü§ó', 'ü§©', 'üíù', 'üíü', '‚ù£Ô∏è', 'üíå', 'üë©‚Äç‚ù§Ô∏è‚Äçüë®', 'üíë', 'üíè'];

// Create emoji burst effect
function createEmojiBurst() {
  const burstContainer = document.getElementById('loveBurst');
  burstContainer.style.display = 'block';
  
  // Create center heart
  const centerHeart = burstContainer.querySelector('.center-burst');
  
  // Create multiple emojis flying out
  for (let i = 0; i < 50; i++) {
    setTimeout(() => {
      const emoji = document.createElement('div');
      emoji.className = 'love-emoji';
      emoji.textContent = loveEmojis[Math.floor(Math.random() * loveEmojis.length)];
      
      const angle = Math.random() * Math.PI * 2;
      const distance = 100 + Math.random() * 300;
      const tx = Math.cos(angle) * distance + 'px';
      const ty = Math.sin(angle) * distance + 'px';
      
      emoji.style.setProperty('--tx', tx);
      emoji.style.setProperty('--ty', ty);
      emoji.style.left = '50%';
      emoji.style.top = '50%';
      
      burstContainer.appendChild(emoji);
      
      setTimeout(() => {
        if (emoji.parentNode) {
          emoji.parentNode.removeChild(emoji);
        }
      }, 3000);
    }, i * 50);
  }
  
  // After burst, start the main content
  setTimeout(() => {
    burstContainer.style.display = 'none';
    startMainExperience();
  }, 3500);
}

function verifyNickname() {
  const answer = nicknameInput.value.trim().toLowerCase();
  errorMessage.textContent = '';
  successMessage.textContent = '';
  
  if (!answer) {
    errorMessage.textContent = 'Please enter your nickname! üí≠';
    nicknameInput.focus();
    return;
  }
  
  if (correctAnswers.includes(answer)) {
    // Correct answer - show success
    successMessage.textContent = 'Access Granted! Welcome, Bannu..! üíñ';
    verifyButton.disabled = true;
    nicknameInput.disabled = true;
    
    // Save verification status to localStorage
    localStorage.setItem('birthdayVerified', 'true');
    
    // Add celebration effects
    verification.style.background = 'linear-gradient(135deg, #4a001a, #8b0000, #000)';
    document.querySelector('.verification-box').style.borderColor = '#4effe6';
    document.querySelector('.verification-box').style.boxShadow = '0 0 80px #4effe6';
    
    // Create floating hearts
    for (let i = 0; i < 20; i++) {
      setTimeout(() => {
        const heart = document.createElement('div');
        heart.className = 'heart';
        heart.textContent = '‚ù§Ô∏è';
        heart.style.left = Math.random() * 100 + 'vw';
        heart.style.fontSize = (Math.random() * 20 + 20) + 'px';
        verification.appendChild(heart);
        
        setTimeout(() => heart.remove(), 6000);
      }, i * 200);
    }
    
    // After celebration, show emoji burst
    setTimeout(createEmojiBurst, 2000);
    
  } else {
    // Wrong answer
    errorMessage.textContent = "That's not quite right! üíî Try again...";
    nicknameInput.value = '';
    nicknameInput.focus();
    
    // Shake animation
    verification.classList.add('shake');
    setTimeout(() => verification.classList.remove('shake'), 500);
    
    // Show more specific hint after 2nd wrong attempt
    if (errorMessage.dataset.attempts) {
      errorMessage.dataset.attempts = parseInt(errorMessage.dataset.attempts) + 1;
    } else {
      errorMessage.dataset.attempts = 1;
    }
    
    if (errorMessage.dataset.attempts >= 2) {
      errorMessage.textContent += " Think of how I sweetly call you... üíï";
    }
  }
}

// Event listeners for verification
verifyButton.addEventListener('click', verifyNickname);
nicknameInput.addEventListener('keypress', (e) => {
  if (e.key === 'Enter') {
    verifyNickname();
  }
});

// ===== MAIN EXPERIENCE =====
function startMainExperience() {
  verification.style.display = 'none';
  document.getElementById('terminal').style.display = 'block';
  runTerminal();
}

// ===== TYPING SOUND SYSTEM =====
class TypingSound {
  constructor() {
    this.audioContext = null;
    this.soundBuffers = {};
    this.isLoaded = false;
    this.userInteracted = false;
    this.soundSources = [];
    
    // Sound file URLs - you'll need to add these files to your project
    this.soundFiles = {
      'type': './typewriter-key.mp3',          // Main typing sound
      'enter': './keyboard-enter.mp3',         // Enter key sound
      'success': './success-chime.mp3',        // Success sound
      'progress': './keyboard-space.mp3'       // Progress sound
    };
    
    // Initialize audio on user interaction
    document.addEventListener('click', () => this.initAudio());
    document.addEventListener('touchstart', () => this.initAudio());
  }
  
  initAudio() {
    if (!this.userInteracted) {
      this.userInteracted = true;
      this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
      this.loadSounds();
    }
  }
  
  async loadSounds() {
    try {
      // Load all sound files
      for (const [key, url] of Object.entries(this.soundFiles)) {
        const response = await fetch(url);
        const arrayBuffer = await response.arrayBuffer();
        this.soundBuffers[key] = await this.audioContext.decodeAudioData(arrayBuffer);
      }
      this.isLoaded = true;
      console.log("All typing sounds loaded successfully");
    } catch (error) {
      console.error("Failed to load sound files:", error);
      // Fallback to using the Web Audio API if sound files can't be loaded
    }
  }
  
  playTypeSound() {
    if (!this.userInteracted || !this.audioContext) return;
    
    try {
      // If sound files are loaded, play them
      if (this.isLoaded && this.soundBuffers['type']) {
        this.playSoundFromBuffer('type');
      } else {
        // Fallback to original synthetic sound
        this.playSyntheticTypeSound();
      }
    } catch (e) {
      console.log("Typing sound error:", e);
      // Fallback to synthetic sound
      this.playSyntheticTypeSound();
    }
  }
  
  playEnterSound() {
    if (!this.userInteracted || !this.audioContext) return;
    
    try {
      if (this.isLoaded && this.soundBuffers['enter']) {
        this.playSoundFromBuffer('enter');
      } else {
        this.playSyntheticEnterSound();
      }
    } catch (e) {
      console.log("Enter sound error:", e);
      this.playSyntheticEnterSound();
    }
  }
  
  playSuccessSound() {
    if (!this.userInteracted || !this.audioContext) return;
    
    try {
      if (this.isLoaded && this.soundBuffers['success']) {
        this.playSoundFromBuffer('success');
      } else {
        this.playSyntheticSuccessSound();
      }
    } catch (e) {
      console.log("Success sound error:", e);
      this.playSyntheticSuccessSound();
    }
  }
  
  playProgressSound() {
    if (!this.userInteracted || !this.audioContext) return;
    
    try {
      if (this.isLoaded && this.soundBuffers['progress']) {
        this.playSoundFromBuffer('progress');
      } else {
        this.playSyntheticProgressSound();
      }
    } catch (e) {
      console.log("Progress sound error:", e);
      this.playSyntheticProgressSound();
    }
  }
  
  playSoundFromBuffer(soundKey) {
    try {
      const source = this.audioContext.createBufferSource();
      source.buffer = this.soundBuffers[soundKey];
      
      // Create gain node for volume control
      const gainNode = this.audioContext.createGain();
      
      // Set volume based on sound type
      switch(soundKey) {
        case 'type':
          gainNode.gain.value = 0.3; // Typing volume
          break;
        case 'enter':
          gainNode.gain.value = 0.4; // Enter volume
          break;
        case 'success':
          gainNode.gain.value = 0.5; // Success volume
          break;
        case 'progress':
          gainNode.gain.value = 0.25; // Progress volume
          break;
        default:
          gainNode.gain.value = 0.3;
      }
      
      // Connect nodes
      source.connect(gainNode);
      gainNode.connect(this.audioContext.destination);
      
      // Add to tracking array for cleanup
      this.soundSources.push(source);
      
      // Play the sound
      source.start();
      
      // Clean up after sound finishes
      source.addEventListener('ended', () => {
        const index = this.soundSources.indexOf(source);
        if (index > -1) {
          this.soundSources.splice(index, 1);
        }
      });
      
    } catch (e) {
      console.log(`Error playing ${soundKey} sound:`, e);
    }
  }
  
  // Original synthetic sounds as fallback methods
  playSyntheticTypeSound() {
    try {
      const oscillator = this.audioContext.createOscillator();
      const gainNode = this.audioContext.createGain();
      
      oscillator.type = 'sine';
      oscillator.frequency.value = 800 + Math.random() * 400;
      
      gainNode.gain.value = 0.1;
      gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.05);
      
      oscillator.connect(gainNode);
      gainNode.connect(this.audioContext.destination);
      
      oscillator.start();
      oscillator.stop(this.audioContext.currentTime + 0.05);
      
    } catch (e) {
      console.log("Synthetic typing sound error:", e);
    }
  }
  
  playSyntheticEnterSound() {
    try {
      const oscillator = this.audioContext.createOscillator();
      const gainNode = this.audioContext.createGain();
      
      oscillator.type = 'sine';
      oscillator.frequency.value = 1200;
      
      gainNode.gain.value = 0.15;
      gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.1);
      
      oscillator.connect(gainNode);
      gainNode.connect(this.audioContext.destination);
      
      oscillator.start();
      oscillator.stop(this.audioContext.currentTime + 0.1);
      
    } catch (e) {
      console.log("Synthetic enter sound error:", e);
    }
  }
  
  playSyntheticSuccessSound() {
    try {
      const oscillator = this.audioContext.createOscillator();
      const gainNode = this.audioContext.createGain();
      
      oscillator.type = 'triangle';
      oscillator.frequency.setValueAtTime(800, this.audioContext.currentTime);
      oscillator.frequency.exponentialRampToValueAtTime(1200, this.audioContext.currentTime + 0.1);
      
      gainNode.gain.value = 0.2;
      gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.2);
      
      oscillator.connect(gainNode);
      gainNode.connect(this.audioContext.destination);
      
      oscillator.start();
      oscillator.stop(this.audioContext.currentTime + 0.2);
      
    } catch (e) {
      console.log("Synthetic success sound error:", e);
    }
  }
  
  playSyntheticProgressSound() {
    try {
      const oscillator = this.audioContext.createOscillator();
      const gainNode = this.audioContext.createGain();
      
      oscillator.type = 'square';
      oscillator.frequency.value = 600 + Math.random() * 200;
      
      gainNode.gain.value = 0.08;
      gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.08);
      
      oscillator.connect(gainNode);
      gainNode.connect(this.audioContext.destination);
      
      oscillator.start();
      oscillator.stop(this.audioContext.currentTime + 0.08);
      
    } catch (e) {
      console.log("Synthetic progress sound error:", e);
    }
  }
  
  // Clean up method
  stopAllSounds() {
    this.soundSources.forEach(source => {
      try {
        source.stop();
      } catch (e) {
        // Source might already be stopped
      }
    });
    this.soundSources = [];
  }
}
// Create typing sound instance
const typingSound = new TypingSound();

// ===== TERMINAL FUNCTIONS =====
const terminal = document.getElementById('terminal');
const bgm = document.getElementById('bgm');
const audioInstruction = document.getElementById('audioInstruction');
const packages = ['love','happiness','trust','smiles','memories','forever'];
let step = 0;
let audioStarted = false;

// Set audio properties
bgm.volume = 0.7;

function typeLine(text, cb){
  let i = 0;
  const line = document.createElement('div');
  terminal.appendChild(line);
  
  const typeInterval = setInterval(() => {
    if (text[i] !== ' ' && text[i] !== undefined) {
      typingSound.playTypeSound();
    }
    
    line.innerHTML = text.slice(0, i) + '<span class="cursor">|</span>';
    i++;
    
    if(i > text.length){
      clearInterval(typeInterval);
      line.innerHTML = text;
      typingSound.playEnterSound();
      
      setTimeout(() => {
        if(typeof cb === 'function') cb();
      }, 300);
    }
  }, 40);
}

function progressBar(cb){
  const bar = document.createElement('div');
  terminal.appendChild(bar);
  let f = 0;
  const total = 10;
  
  const timer = setInterval(() => {
    f++;
    bar.textContent = `[${'‚ù§'.repeat(f)}${' '.repeat(total - f)}] ${f * 10}%`;
    
    typingSound.playProgressSound();
    
    if(f === total){
      clearInterval(timer);
      typingSound.playSuccessSound();
      
      setTimeout(() => {
        if(typeof cb === 'function') cb();
      }, 500);
    }
  }, 150);
}

function runTerminal(){
  if(step < packages.length){
    const p = packages[step];
    typeLine(`C:/heart/> npm install ${p}`, () => {
      progressBar(() => {
        const ok = document.createElement('div');
        ok.textContent = `‚úî ${p} installed`;
        terminal.appendChild(ok);
        step++;
        runTerminal();
      });
    });
    return;
  }

  setTimeout(() => {
    terminal.style.display = 'none';
    document.getElementById('surprise').style.display = 'block';
    startSlideshow();
  }, 800);
}

// ===== SLIDESHOW FUNCTIONS =====
function startSlideshow(){
  const slides = Array.from(document.querySelectorAll('.slide'));
  let idx = 0;
  let slideTimer = null;
  
  audioInstruction.style.display = 'block';
  
  function startAudio() {
    if (!audioStarted) {
      audioStarted = true;
      audioInstruction.style.display = 'none';
      
      bgm.play().then(() => {
        console.log("Audio started successfully");
      }).catch(error => {
        console.error("Audio play failed:", error);
        audioInstruction.style.display = 'block';
        audioInstruction.textContent = "üéµ Click to allow audio permission üéµ";
        audioStarted = false;
      });
    }
  }
  
  document.addEventListener('click', startAudio);
  document.addEventListener('touchstart', startAudio);
  
  setTimeout(() => {
    bgm.play().then(() => {
      audioStarted = true;
      audioInstruction.style.display = 'none';
    }).catch(() => {
      console.log("Auto-play blocked, waiting for user click");
    });
  }, 100);

  function activateSlide(i){
    slides.forEach(s => s.classList.remove('active'));
    slides[i].classList.add('active');
  }

  const slideDuration = 8000;
  
  activateSlide(0);
  
  slideTimer = setInterval(() => {
    idx = (idx + 1) % slides.length;
    activateSlide(idx);
  }, slideDuration);

  setInterval(createHeart, 400);
  setInterval(createCracker, 500);

  setTimeout(() => {
    clearInterval(slideTimer);
    document.getElementById('surprise').style.display = 'none';
    document.getElementById('photoCollage').style.display = 'block';
    
    setTimeout(() => {
      document.getElementById('photoCollage').style.display = 'none';
      
      // Create final love emoji burst
      createEmojiBurst();
      
      // After burst, reload page
      setTimeout(() => location.reload(), 4000);
    }, 8000);
  }, slideDuration * slides.length);
}

function createHeart(){
  const h = document.createElement('div');
  h.className = 'heart';
  h.textContent = '‚ù§';
  h.style.left = Math.random() * 100 + 'vw';
  h.style.fontSize = (Math.random() * 20 + 20) + 'px';
  document.body.appendChild(h);
  setTimeout(() => h.remove(), 6000);
}

function createCracker(){
  const c = document.createElement('div');
  c.className = 'cracker';
  c.textContent = 'üéâ';
  c.style.left = Math.random() * 100 + 'vw';
  c.style.fontSize = (Math.random() * 25 + 25) + 'px';
  document.body.appendChild(c);
  setTimeout(() => c.remove(), 6000);
}
</script>
</body>
</html>